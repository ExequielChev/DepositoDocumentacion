<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Documentación CIPRES</title>
  <link rel="icon" href="../favicon.png" type="image/png">
  <link rel="stylesheet" href="../style.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
      color: #333;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 950px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,.1);
    }
    h1, h2 {
      color: #005f73;
    }
    .doc-link {
      display: block;
      margin: 10px 0;
      padding: 10px 15px;
      background: #0f62fe;
      color: white;
      text-decoration: none;
      border-radius: 6px;
      transition: background 0.3s ease;
      text-align: center;
    }
    .doc-link:hover {
      background: #084cdf;
    }
    .back-button {
      display: inline-block;
      margin-bottom: 20px;
      background: #6c757d;
      color: white;
      padding: 8px 15px;
      border-radius: 5px;
      text-decoration: none;
    }
    p {
      margin-bottom: 15px;
    }
    ul {
      padding-left: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="../index.html" class="back-button">« Volver al Inicio</a>
    <h1>📄 Documentación General del Proceso - Carga CIPRES</h1>

    <h2>📘 Resumen General</h2>
    <p>
      El proceso automatizado “Carga CIPRES” tiene como objetivo registrar internaciones de pacientes en el sistema web CIPRES, a partir de un Excel generado por otros procesos automatizados. El flujo completo combina tareas humanas y automatizadas. El usuario solicita un reporte desde el sistema <strong>Integrando</strong>, que es procesado por bots que descargan los documentos PDF (F10), extraen datos mediante OCR, y generan un Excel preliminar. Ese Excel es revisado manualmente y luego usado por el bot de carga CIPRES para completar los registros en la intranet hospitalaria.
    </p>

    <p>
      Esta documentación está dividida en cuatro entregables principales, cada uno con un enfoque específico:
    </p>

    <h2>📂 Accesos Directos a las Documentaciones</h2>
    <a href="PAD/PAD_Carga_CIPRES.html" class="doc-link">📄 PAD (Proceso Actual del Usuario)</a>
    <a href="PDD/PDD_Carga_CIPRES_v2.html" class="doc-link">📝 PDD (Diseño del Proceso Automatizado)</a>
    <a href="SDD/SDD_Carga_CIPRES.html" class="doc-link">⚙️ SDD (Diseño Técnico del Script)</a>
    <a href="RB/CIPRESrunbook.html" class="doc-link">📕 Runbook (Libro de Ejecución)</a>

    <h2>📌 Descripción Resumida de Cada Documento</h2>

    <h3>🔹 PAD - Proceso As-Is</h3>
    <ul>
      <li>El usuario accede a Integrando, solicita el reporte mensual de internaciones y descarga un Excel.</li>
      <li>Luego, recorre cada paciente y descarga manualmente los formularios F10.</li>
      <li>Los F10 se imprimen y con ellos, el usuario accede a la intranet para cargar los datos uno por uno en CIPRES.</li>
      <li>Cuando los F10 están incompletos, accede manualmente a la historia clínica para verificar los datos antes de la carga.</li>
    </ul>

    <h3>🔹 PDD - Proceso To-Be</h3>
    <ul>
      <li>El usuario ejecuta la interfaz y solicita bots de descarga y OCR.</li>
      <li>El bot descarga automáticamente los F10 desde Integrando, aplica OCR y construye el Excel.</li>
      <li>El Excel es validado por el usuario antes de ser usado para la carga.</li>
      <li>El bot de carga ingresa a CIPRES, busca al paciente por DNI y sexo, y completa los campos del formulario usando datos del Excel.</li>
      <li>Registra cada resultado en una columna adicional (“Resultado”).</li>
    </ul>

    <h3>🔹 SDD - Diseño Técnico del Bot</h3>
    <ul>
      <li>Implementado en Python 3.11.9 utilizando Selenium, Pandas y Openpyxl.</li>
      <li>El script lee un archivo <code>settings.xlsx</code> que define rutas, URLs y credenciales.</li>
      <li>Se apoya en diccionarios para mapear códigos de enfermedades y causas externas.</li>
      <li>El robot realiza la navegación web, llena los campos, y guarda los registros.</li>
      <li>Registra todos los pasos en logs y en un Excel final.</li>
    </ul>

    <h3>🔹 Runbook - Ejecución del Bot</h3>
    <ul>
      <li>Se ejecuta desde la interfaz gráfica (<code>interfaz.exe</code>).</li>
      <li>Se deben configurar usuario, fechas, hospital, Excel de entrada y URLs desde la sección CONFIGURACIÓN.</li>
      <li>El usuario selecciona el script de carga y lo inicia.</li>
      <li>Los resultados se guardan en <code>outputs/cipres.xlsx</code> y los errores se documentan en <code>logs/evidencias</code>.</li>
    </ul>

    <h2>📎 Observaciones Importantes</h2>
    <ul>
      <li>El proceso requiere conexión a la intranet hospitalaria.</li>
      <li>Los datos deben estar verificados antes de ejecutar la carga.</li>
      <li>Cuando los formularios F10 están incompletos, el bot no puede continuar sin intervención humana.</li>
    </ul>

  </div>
</body>
</html>
