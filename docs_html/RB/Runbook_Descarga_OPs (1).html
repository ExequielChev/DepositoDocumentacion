<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Runbook ‚Äî Descarga y Resumen de OPs</title>
  <style>
    body { font-family: Arial, sans-serif; background-color: #1858d8; color: #222; margin: 0; padding: 0; }
    header { background-color: #0f62fe; color: white; padding: 20px; }
    .container { max-width: 960px; margin: auto; padding: 20px; }
    h1 { margin: 0; font-size: 24px; }
    .meta { margin-top: 5px; font-size: 14px;  }
    section { background: white; margin-top: 20px; border-radius: 8px; padding: 20px; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
    h2 { font-size: 18px; margin-top: 0; }
    ul, ol { margin-left: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #e0e0e0; }
    footer { text-align: center; font-size: 12px; color: #666; margin: 40px 0; }
        :root { --c1:#0f62fe; --c2:#161616; --c3:#525252; --bg:#f7f8fa; }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:#222;line-height:1.5}
    header{background:#0f62fe;border-bottom:1px solid #ffffff}
    .container{max-width:980px;margin:0 auto;padding:24px}
    h1{margin:0 0 8px 0;font-size:28px;color:#000000}
    .meta{color:#ffffff;font-size:14px;margin-bottom:16px}
    section{background:#fff;border:1px solid #eef0f3;border-radius:10px;padding:20px;margin:14px 0}
    h2{font-size:18px;color:var(--c2);margin:0 0 10px 0}
    h3{font-size:15px;color:var(--c2);margin:14px 0 8px 0}
    ul{margin:8px 0 8px 18px}
    ol{margin:8px 0 8px 18px}
    table{width:100%;border-collapse:collapse;margin:8px 0}
    th,td{border:1px solid #e5e7eb;padding:8px;text-align:left;font-size:14px}
    th{background:#f3f4f6}
    .badge{display:inline-block;background:var(--c1);color:#fff;border-radius:999px;padding:2px 10px;font-size:12px;margin-left:8px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:720px){.grid{grid-template-columns:1fr}}
    .note{background:#eef5ff;border-left:4px solid var(--c1);padding:10px;border-radius:6px}
    footer{color:#6b7280;font-size:12px;padding:16px 24px}
    code{background:#f3f4f6;padding:2px 6px;border-radius:6px;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace}
    .view-flowchart-link {
    display: inline-block; background-color: #3498db; color: white !important;
    padding: 10px 15px; text-decoration: none; border-radius: 5px;
    font-size: 0.95em; transition: background-color 0.3s ease;
    margin-bottom: 10px; border: none;
    }
    .view-flowchart-link:hover { background-color: #2980b9; color: white !important; }
    .script-feature { font-style: italic; color: #555; }
    .back-to-index-btn {
        background-color: #6c757d; color: white !important; padding: 8px 15px;
        text-decoration: none; border-radius: 5px; font-size: 0.9em;
        transition: background-color 0.3s ease; border: none;
    }
    .back-to-index-btn:hover { background-color: #5a6268; }

</style>
</head>
<body>
    <div class="container" style="background-color: transparent; box-shadow: none; padding-bottom:1; margin-bottom:1;">
    <div class="page-navigation">
      <a href="../../index.html" class="back-to-index-btn">¬´ Volver al Inicio</a>
      <a href="../descargaop.html" class="back-to-index-btn">¬´ Volver a la Documentacion General</a>
    </div>
  </div>
  
<h1>üßæ Runbook ‚Äî Descarga y Resumen de OPs</h1>

<section>
  <h2>üìå Objetivo</h2>
  <p>Ejecutar el script de automatizaci√≥n que descarga PDFs de OPs desde el sistema Major y genera un archivo Excel consolidado con los datos clave de cada orden de pago.</p>
</section>

<section>
  <h2>üìÅ Estructura esperada</h2>
  <pre><code>bot_op/
‚îú‚îÄ‚îÄ popups/
‚îÇ   ‚îú‚îÄ‚îÄ BOTONIMPRIMIR.png
‚îÇ   ‚îî‚îÄ‚îÄ otras_imagenes.png
‚îú‚îÄ‚îÄ script.py
‚îî‚îÄ‚îÄ ejecutable.exe (opcional)
</code></pre>
</section>

<section>
  <h2>‚öôÔ∏è Pasos para la ejecuci√≥n</h2>
  <ol>
    <li>Ejecutar el script o ejecutable.</li>
    <li>Ingresar <strong>usuario</strong> y <strong>contrase√±a</strong> del sistema Major.</li>
    <li>Seleccionar el archivo Excel con columnas "Tipo de OP" y "N√∫mero de OP".</li>
    <li>Esperar que el bot abra el sistema, cargue cada OP, imprima el PDF y guarde los datos.</li>
    <li>Una vez procesadas todas las OPs, se abrir√° autom√°ticamente la carpeta con los resultados.</li>
  </ol>
</section>


<section id="parametros-config">
  <h2>üîë Par√°metros de configuraci√≥n</h2>
  <table class="config-table">
    <thead>
      <tr><th>Campo</th><th>Descripci√≥n</th></tr>
    </thead>
    <tbody>
      <tr><td>Usuario</td><td>Usuario de acceso al sistema Major</td></tr>
      <tr><td>Contrase√±a</td><td>Contrase√±a de acceso al sistema Major</td></tr>
      <tr><td>Nombre Excel</td><td>Ruta y nombre del archivo Excel de entrada con columnas <code>Tipo de OP</code> y <code>N√∫mero de OP</code></td></tr>
      <tr><td>Nombre Hoja Excel</td><td>Nombre de la hoja donde est√°n listadas las OPs (por defecto <code>Sheet1</code>)</td></tr>
      <tr><td>Imagen_Boton_Imprimir</td><td>Ruta a la imagen del bot√≥n imprimir: <code>popups/BOTONIMPRIMIR.png</code></td></tr>
    </tbody>
  </table>
</section>


<section>
  <h2>üì¶ Resultados</h2>
  <ul>
    <li>üìÅ <code>OP_DESCARGAS/OPS_FECHA/</code>: PDFs generados por cada OP.</li>
    <li>üìÅ <code>OP_DESCARGAS/EXCEL GENERADO OP FECHA/</code>: Archivo Excel con los siguientes campos:</li>
    <ul>
      <li>PROVEEDOR</li>
      <li>F.F</li>
      <li>NRO OP</li>
      <li>OC</li>
      <li>BRUTO OP</li>
      <li>NETO OP</li>
      <li>DETALLE CONTRATACI√ìN</li>
      <li>FDO. AFECTADO</li>
      <li>CF</li>
    </ul>
  </ul>
</section>

<section>
  <h2>üõ†Ô∏è Posibles errores comunes</h2>
  <ul>
    <li>üîí El sistema Major no abre correctamente: revisar ruta del ejecutable.</li>
    <li>üñºÔ∏è No se detecta el bot√≥n de imprimir: verificar imagen en la carpeta <code>popups/</code>.</li>
    <li>üìù No se genera Excel: asegurarse de que haya PDFs v√°lidos y que el Excel fuente est√© bien formateado.</li>
  </ul>
</section>

<section>
  <h2>üìçNotas adicionales</h2>
  <ul>
    <li>El script no guarda contrase√±as.</li>
    <li>El sistema debe tener acceso a red y permisos para abrir el ejecutable del Major.</li>
    <li>Revisar siempre los resultados del Excel antes de enviar.</li>
  </ul>
</section>

<footer>
  Documento Runbook ‚Äî Uso operativo del bot de Descarga y Resumen de OPs
</footer>

</body>
</html>
