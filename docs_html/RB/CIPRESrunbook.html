<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Runbook - Carga CIPRES</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 20px;
      color: #333;
      line-height: 1.6;
    }

    h1, h2, h3 {
      color: #005f73;
    }

    h1 {
      text-align: center;
      margin-bottom: 30px;
    }

    code, pre {
      background-color: #f4f4f4;
      padding: 10px;
      border-radius: 5px;
      display: block;
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }

    table, th, td {
      border: 1px solid #ccc;
    }

    th, td {
      padding: 10px;
      text-align: left;
    }

    th {
      background-color: #e0f7fa;
    }

    .section {
      margin-top: 40px;
    }

    .view-flowchart-link {
    display: inline-block; background-color: #3498db; color: white !important;
    padding: 10px 15px; text-decoration: none; border-radius: 5px;
    font-size: 0.95em; transition: background-color 0.3s ease;
    margin-bottom: 10px; border: none;
    }
    .view-flowchart-link:hover { background-color: #2980b9; color: white !important; }
    .script-feature { font-style: italic; color: #555; }
    .back-to-index-btn {
        background-color: #6c757d; color: white !important; padding: 8px 15px;
        text-decoration: none; border-radius: 5px; font-size: 0.9em;
        transition: background-color 0.3s ease; border: none;
    }
    .back-to-index-btn:hover { background-color: #5a6268; }
      </style>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
      <link rel="icon" href="../favicon.ico" type="image/x-icon">
      <link rel="stylesheet" href="../../style.css">

  </style>
</head>
<body>
    <div class="container" style="background-color: transparent; box-shadow: none; padding-bottom:0; margin-bottom:0;">
        <div class="page-navigation">
            <a href="../documentacion_cipres.html" class="back-to-index-btn">Â« Volver al Inicio</a>
        </div>
    </div>

  <h1>ğŸ§¾ RUNBOOK - CARGA DE INTERNACIONES EN CIPRES</h1>

  <div class="section">
    <h2>ğŸ“Œ Objetivo</h2>
    <p>Automatizar el proceso de carga de registros de internaciÃ³n en el sistema <strong>CIPRES</strong>, a partir de un archivo Excel procesado previamente con bots de descarga y OCR.</p>
  </div>

  <div class="section">
    <h2>ğŸ“ Estructura del proyecto</h2>
    <pre><code>Bots_CoParticipacion/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ settings.xlsx
â”‚   â”œâ”€â”€ modulos/
â”‚   â”‚   â”œâ”€â”€ descarga.py
â”‚   â”‚   â”œâ”€â”€ ocr.py
â”‚   â”‚   â””â”€â”€ carga_cipres.py
â”‚   â””â”€â”€ interfaz.exe
â”œâ”€â”€ inputs/
â”‚   â”œâ”€â”€ dic_diagnosticos_hombre.xlsx
â”‚   â”œâ”€â”€ dic_diagnosticos_mujer.xlsx
â”‚   â”œâ”€â”€ dic_causas_externas.xlsx
â”‚   â”œâ”€â”€ excel_carga_cipres.xlsx
â”‚   â””â”€â”€ pdfs/
â”‚       â””â”€â”€ 2025-07-01-2025-07-31/
â”œâ”€â”€ outputs/
â”‚   â”œâ”€â”€ dataset/
â”‚   â””â”€â”€ cipres.xlsx
â””â”€â”€ logs/
    â””â”€â”€ evidencias/
</code></pre>
  </div>

  <div class="section">
    <h2>ğŸ”§ ConfiguraciÃ³n Inicial</h2>
    <ol>
      <li>Ejecutar <code>interfaz.exe</code> desde la carpeta <code>app</code>.</li>
      <li>Presionar <strong>CONFIGURACIÃ“N</strong>.</li>
      <li>Completar los campos:</li>
    </ol>

    <table>
      <thead>
        <tr>
          <th>Campo</th>
          <th>DescripciÃ³n</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Usuario</td><td>Usuario de acceso</td></tr>
        <tr><td>ContraseÃ±a</td><td>ContraseÃ±a</td></tr>
        <tr><td>Ruta de la carpeta</td><td>Ruta completa al proyecto</td></tr>
        <tr><td>Nombre Excel</td><td>Ruta del archivo <code>excel_carga_cipres.xlsx</code></td></tr>
        <tr><td>Nombre Hoja Excel</td><td>Generalmente <code>Sheet1</code></td></tr>
        <tr><td>URL_LOGIN</td><td>URL del login de CIPRES</td></tr>
        <tr><td>URL_INTERN</td><td>URL para carga de internaciones</td></tr>
        <tr><td>EXCEL_OUT</td><td>Ruta para guardar resultados</td></tr>
        <tr><td>Usuario_Integrando</td><td>Usuario de Integrando</td></tr>
        <tr><td>ContraseÃ±a_Integrando</td><td>ContraseÃ±a de Integrando</td></tr>
        <tr><td>Fecha Inicio / Fin</td><td>Rango de fechas de las internaciones</td></tr>
        <tr><td>Efector</td><td>Hospital o instituciÃ³n</td></tr>
      </tbody>
    </table>

    <p>Presionar <strong>Guardar Cambios</strong> al finalizar.</p>
  </div>

  <div class="section">
    <h2>â–¶ï¸ EjecuciÃ³n</h2>
    <ol>
      <li>Volver a la pantalla principal.</li>
      <li>Seleccionar <strong>SELECCIONAR SCRIPT</strong>.</li>
      <li>Marcar Ãºnicamente <code>carga_cipres.py</code>.</li>
      <li>Presionar <strong>INICIAR</strong>.</li>
      <li>Ver logs en tiempo real desde el visor en la interfaz.</li>
    </ol>
  </div>

  <div class="section">
    <h2>ğŸ“¦ Resultados</h2>
    <ul>
      <li><code>outputs/cipres.xlsx</code>: archivo con estado de cada internaciÃ³n.</li>
      <li><code>logs/evidencias/</code>: registros y capturas.</li>
    </ul>
  </div>

  <div class="section">
    <h2>ğŸ› ï¸ Posibles errores comunes</h2>
    <table>
      <thead>
        <tr>
          <th>Error</th>
          <th>Causa</th>
          <th>SoluciÃ³n</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>El bot no inicia</td><td><code>settings.xlsx</code> mal configurado</td><td>Revisar rutas y credenciales</td></tr>
        <tr><td>No encuentra archivo Excel</td><td>Ruta o nombre de hoja incorrectos</td><td>Verificar campos <code>Nombre Excel</code> y <code>Hoja</code></td></tr>
        <tr><td>Carga parcial</td><td>Datos mal estructurados</td><td>Revisar salida del OCR y validaciÃ³n previa</td></tr>
      </tbody>
    </table>
  </div>

  <div class="section">
    <h2>ğŸ“Notas adicionales</h2>
    <ul>
      <li>La interfaz no requiere conexiÃ³n para abrir, pero sÃ­ para acceder a <strong>CIPRES e Integrando</strong>.</li>
      <li>Ejecutar solo cuando los datos estÃ©n validados correctamente.</li>
    </ul>
  </div>

</body>
</html>
