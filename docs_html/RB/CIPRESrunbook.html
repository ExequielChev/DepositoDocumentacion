<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Runbook - Carga CIPRES</title>
  <link rel="icon" href="../../favicon.png" type="image/png">
  <link rel="stylesheet" href="../../style.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 20px;
      color: #333;
      line-height: 1.6;
    }
    h1, h2, h3 {
      color: #005f73;
    }
    h1 { text-align: center; margin-bottom: 30px; }
    code, pre {
      background-color: #f4f4f4;
      padding: 10px;
      border-radius: 5px;
      display: block;
      overflow-x: auto;
    }
    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
    table, th, td { border: 1px solid #ccc; }
    th, td { padding: 10px; text-align: left; }
    th { background-color: #e0f7fa; }
    .section { margin-top: 40px; }
    .view-flowchart-link {
      display: inline-block;
      background-color: #3498db;
      color: white !important;
      padding: 10px 15px;
      text-decoration: none;
      border-radius: 5px;
      font-size: 0.95em;
      margin-bottom: 10px;
    }
    .view-flowchart-link:hover { background-color: #2980b9; }
    .back-to-index-btn {
      background-color: #6c757d;
      color: white !important;
      padding: 8px 15px;
      text-decoration: none;
      border-radius: 5px;
      font-size: 0.9em;
      transition: background-color 0.3s ease;
    }
    .back-to-index-btn:hover { background-color: #5a6268; }

    header {
      background-color: #005f73;
      color: white;
      padding: 20px 0;
    }

    header h1 {
      color: white;
      font-size: 1.8em;
      text-align: center;
      margin: 0;
    }

    header .meta {
      text-align: center;
      margin-top: 10px;
      font-size: 0.95em;
      color: white;
    }

    header .badge {
      background-color: #00bcd4;
      color: white;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 0.85em;
      margin-left: 10px;
    }

  </style>
</head>
<body>


    <div class="container" style="background-color: transparent; box-shadow: none; padding-bottom:1; margin-bottom:1;">
        <div class="page-navigation">
            <a href="../../index.html" class="back-to-index-btn">Â« Volver al Inicio</a>
            <a href="../documentacion_cipres.html" class="back-to-index-btn">Â« Volver a la Documentacion General</a>
        </div>
    </div>
  <header>
    <div class="container">
      <h1>ğŸ§¾ RUNBOOK - CARGA DE INTERNACIONES EN CIPRES</h1>
      <div class="meta">
        Fecha: 04/08/2025 Â· Autor: Zahir Â· Ãrea responsable: Registro de Internaciones â€” Hospitales
        <span class="badge">VersiÃ³n 1.0</span>
      </div>
    </div>

  </header>

  <div class="section">
    <h2>ğŸ“Œ Objetivo</h2>
    <p>Automatizar el proceso de carga de registros de internaciÃ³n en <strong>CIPRES</strong> a partir de documentos generados por Integrando, procesados mediante bots de descarga, OCR y carga.</p>
  </div>

  <div class="section">
    <h2>ğŸ“ Paso a Paso General</h2>
    <ol>
      <li>El usuario solicita a travÃ©s del sistema <strong>Integrando</strong> los listados de egresos mensuales, seleccionando el <strong>efector</strong> y el <strong>rango de fechas</strong> de egreso.</li>
      <li>Ejecutar la interfaz ubicada en <code>app/interfaz.exe</code>.</li>
      <li>En la interfaz, seleccionar Ãºnicamente los scripts:
        <ul>
          <li><code>descarga.py</code></li>
          <li><code>ocr.py</code></li>
        </ul>
      </li>
      <li>Los bots dejarÃ¡n los archivos en:
        <ul>
          <li><code>inputs/pdfs/...</code> â€” PDFs descargados.</li>
          <li><code>inputs/excel_carga_cipres.xlsx</code> â€” Excel generado por OCR.</li>
        </ul>
      </li>
      <li>Enviar el Excel generado al usuario para su revisiÃ³n manual.</li>
      <li>Una vez corregido, reemplazarlo en la carpeta <code>inputs</code> con el mismo nombre.</li>
      <li>Ejecutar nuevamente <code>interfaz.exe</code>, seleccionar solo <code>carga_cipres.py</code> y presionar <strong>INICIAR</strong>.</li>
    </ol>
  </div>

  <div class="section">
    <h2>ğŸ“ Estructura del proyecto</h2>
    <pre><code>Bots_CoParticipacion/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ settings.xlsx
â”‚   â”œâ”€â”€ modulos/
â”‚   â”‚   â”œâ”€â”€ descarga.py
â”‚   â”‚   â”œâ”€â”€ ocr.py
â”‚   â”‚   â””â”€â”€ carga_cipres.py
â”‚   â””â”€â”€ interfaz.exe
â”œâ”€â”€ inputs/
â”‚   â”œâ”€â”€ excel_carga_cipres.xlsx
â”‚   â”œâ”€â”€ dic_diagnosticos_hombre.xlsx
â”‚   â”œâ”€â”€ dic_diagnosticos_mujer.xlsx
â”‚   â”œâ”€â”€ dic_causas_externas.xlsx
â”‚   â””â”€â”€ pdfs/
â”‚       â””â”€â”€ 2025-07-01-2025-07-31/
â”œâ”€â”€ outputs/
â”‚   â”œâ”€â”€ dataset/
â”‚   â””â”€â”€ cipres.xlsx
â””â”€â”€ logs/
    â””â”€â”€ evidencias/
</code></pre>
  </div>

  <div class="section">
    <h2>ğŸ§· ConfiguraciÃ³n inicial</h2>
    <p>Desde la interfaz, presionar <strong>CONFIGURACIÃ“N</strong> y completar los siguientes campos:</p>
    <table>
      <tr><th>Campo</th><th>DescripciÃ³n</th></tr>
      <tr><td>Usuario / ContraseÃ±a</td><td>Credenciales de acceso a CIPRES</td></tr>
      <tr><td>Ruta de la carpeta</td><td>Ruta absoluta al proyecto</td></tr>
      <tr><td>Nombre Excel</td><td>Debe ser <code>excel_carga_cipres.xlsx</code></td></tr>
      <tr><td>Nombre Hoja Excel</td><td>Ejemplo: <code>Sheet1</code></td></tr>
      <tr><td>URL_LOGIN / URL_INTERN</td><td>URLs del sistema CIPRES</td></tr>
      <tr><td>Usuario / ContraseÃ±a Integrando</td><td>Credenciales de descarga</td></tr>
      <tr><td>Fecha inicio / fin</td><td>Rango del perÃ­odo</td></tr>
      <tr><td>Efector</td><td>Hospital o instituciÃ³n</td></tr>
    </table>
    <p>Presionar <strong>Guardar Cambios</strong>.</p>
  </div>

  <div class="section">
    <h2>â–¶ï¸ EjecuciÃ³n final</h2>
    <ol>
      <li>Volver al menÃº principal.</li>
      <li>Seleccionar <strong>SELECCIONAR SCRIPT</strong>.</li>
      <li>Marcar solo <code>carga_cipres.py</code>.</li>
      <li>Presionar <strong>INICIAR</strong>.</li>
    </ol>
  </div>

  <div class="section">
    <h2>ğŸ“¦ Resultados generados</h2>
    <ul>
      <li><code>outputs/cipres.xlsx</code>: resultados por fila.</li>
      <li><code>logs/evidencias/</code>: logs, screenshots y errores.</li>
    </ul>
  </div>

  <div class="section">
    <h2>âš ï¸ Posibles errores comunes</h2>
    <table>
      <tr><th>Error</th><th>Posible causa</th><th>SoluciÃ³n</th></tr>
      <tr><td>No inicia</td><td>settings.xlsx mal configurado</td><td>Revisar rutas y credenciales</td></tr>
      <tr><td>Excel no encontrado</td><td>Ruta incorrecta</td><td>Corregir en configuraciÃ³n</td></tr>
      <tr><td>Carga parcial</td><td>OCR incompleto o datos faltantes</td><td>Validar el Excel revisado</td></tr>
    </table>
  </div>

  
  <section id="diagrama-tobe">
    <h3>Diagrama de Flujo Ejecucion: CIPRES</h3>
    <div style="background: #f9fafb; border: 1px solid #e5e7eb; padding: 20px; border-radius: 12px; margin-top: 20px;">
      <a href="diagrama_rb/diagramaRB_Cipres.html"
        style="
          display: inline-block;
          background-color: #0f62fe;
          color: white;
          padding: 12px 20px;
          text-decoration: none;
          border-radius: 8px;
          font-weight: 500;
          font-family: inherit;
          text-align: center;
        ">
        Ver Diagrama de Flujo Ejecucion
      </a>
    </div>
  </section>


  <div class="section">
    <h2>ğŸ“Notas importantes</h2>
    <ul>
      <li>En caso de que un <strong>F10 estÃ© incompleto</strong>, el usuario debe ingresar manualmente a la historia clÃ­nica para completar los datos.</li>
      <li>Este paso no puede ser automatizado.</li>
      <li>El Excel revisado debe tener todos los campos mÃ­nimos requeridos por CIPRES.</li>
    </ul>
  </div>

</body>
</html>
